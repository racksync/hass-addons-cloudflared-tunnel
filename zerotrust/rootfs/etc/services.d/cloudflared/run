#!/usr/bin/with-contenv bashio
# ==============================================================================
# Execute Cloudflare Daemon
# ==============================================================================

TOKEN=$(bashio::config 'token')

bashio::log.info "Starting Cloudflare Services"
bashio::log.info "Fetching Data from Zero Trust Platform"
bashio::log.info "This addon is under maintenance by RACKSYNC"
mkdir -p /root/.cloudflared/
cp -Rv /ssl/* /root/.cloudflared/

if bashio::config.true 'config'; then
    exec cloudflared tunnel --config /root/.cloudflared/config.yaml run
else
    exec cloudflared tunnel run --force --token $TOKEN
fi



